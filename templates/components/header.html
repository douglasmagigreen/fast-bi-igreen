{# templates/components/header.html #}
<header class="content-header">
    {# Usa o block page_title definido na página que estende o layout #}
    <h1 class="page-title">{% block page_title %}Dashboard{% endblock %}</h1>
    <div class="header-user-info">
        {% if current_user.is_authenticated %}
            <span title="Usuário logado">{{ current_user.nome | default('Utilizador', true) }}</span>
            <span class="current-date" style="margin-left: auto; margin-right: 15px;" title="Data atual"></span> {# Data será preenchida por JS #}
            <a href="{{ url_for('auth_bp.logout') }}" class="btn-logout-alt" title="Sair"><i class="fas fa-sign-out-alt"></i></a>
        {% endif %}
    </div>
    {# Script JS para data movido para cá para manter o componente encapsulado #}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const dateElement = document.querySelector('.current-date');
            if (dateElement) {
                const now = new Date();
                const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                try {
                    let formattedDate = now.toLocaleDateString('pt-BR', options);
                    formattedDate = formattedDate.replace(/^\w/, c => c.toUpperCase()).replace(/\b\w/g, (l, idx) => (idx > 0 && formattedDate[idx-2] !== ' ' && formattedDate[idx-2] !== '-') ? l : l.toUpperCase());
                    dateElement.textContent = formattedDate;
                } catch (e) {
                     const day = String(now.getDate()).padStart(2, '0');
                     const month = String(now.getMonth() + 1).padStart(2, '0');
                     const year = now.getFullYear();
                     dateElement.textContent = `<span class="math-inline">\{day\}/</span>{month}/${year}`;
                     console.warn("toLocaleDateString('pt-BR') não suportado, usando fallback DD/MM/YYYY.");
                }
            }
        });
    </script>
</header>